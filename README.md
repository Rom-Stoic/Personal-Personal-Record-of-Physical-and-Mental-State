# ROM 日常数据记录应用
欢迎使用 ROM （Reflective Ontological Matrix）日常数据记录应用！这是一个简单的 Web 应用程序，旨在帮助您每天记录、跟踪和管理关于睡眠、饮食、运动和情绪等健康指标。所有数据都会被实时保存到一个 Excel 文件中，方便后续进行分析。


## 项目简介
本应用提供了一个用户友好的网页表单，分为“晨间核心指标”、“日间日志”和“晚间反思”三个部分，其中的指标来源于经典的心理学、生物学、医学等研究，能够较为全面地反映个人的身心状态，同时记录起来并不算太复杂。用户可以选择一个日期，填写相关数据，然后点击“保存”按钮。提交的数据将被记录在项目根目录下的**ROM数据模板.xlsx**文件中。如果当天已有记录，本次提交将更新该记录；如果当天没有记录，则会新增一行。

## 技术栈
后端: Python, Flask

数据处理: Pandas, NumPy

前端: HTML, CSS, JavaScript

Excel 文件读写: openpyxl

## 文件结构
.

├── app.py                  # Flask 后端主程序

├── index.html              # 前端网页结构

├── style.css               # 网页样式文件

├── script.js               # 网页交互逻辑

└── ROM数据模板.xlsx        # 数据存储的 Excel 文件

## 安装与设置
在运行此项目之前，您需要先设置好您的本地环境。推荐使用 Anaconda 来管理 Python 环境和依赖包。

### 第 1 步：先决条件

确保您的电脑上已经安装了 Anaconda 或 Miniconda。

### 第 2 步：创建并激活 Conda 虚拟环境

打开您的终端（在 Windows 上是 Anaconda Prompt，在 macOS 或 Linux 上是 Terminal），然后执行以下命令。

创建一个新的虚拟环境 (此处我们命名为 rom_logger，您可以自定义)：

conda create --name rom_logger python=3.9

Conda 会提示您确认安装，输入 y 并按回车。

激活该虚拟环境：

conda activate rom_logger

激活成功后，您会看到终端提示符前面出现了 (rom_logger) 的字样。

### 第 3 步：安装项目依赖

在此虚拟环境中，我们需要安装 Flask、Pandas 等必要的库。

安装依赖库：

conda install Flask pandas numpy openpyxl

这将自动下载并安装项目运行所需的所有 Python 包。

## 如何运行
完成上述所有设置步骤后，您可以启动应用程序。

确保终端路径正确：
在终端中，使用 cd 命令进入包含 app.py 文件的项目根目录。

启动 Flask 服务器：
执行以下命令：

python app.py

启动成功后，您会看到类似以下的输出：

Starting Flask server...

Data will be saved to '.../ROM数据模板.xlsx'

Open http://127.0.0.1:5000 in your browser.

在您的浏览器中打开网址 http://127.0.0.1:5000 ，即可开始使用。

## 使用说明
选择日期：页面顶部的日期选择器默认显示当天日期。您可以点击选择任何您想记录或查看的日期。当您切换日期时，应用会自动从 Excel 文件中加载该日期的已有数据并填充到表单中。

填写数据：根据您的实际情况填写表单中的各个字段。

简单反应时测试 (SRT)：点击“简单反应时”字段旁边的“开始测试”按钮，根据弹窗提示完成5次反应测试，平均值会自动填入表单。

保存数据：填写完毕后，点击页面底部的“保存数据到Excel”按钮。系统会弹出提示，告知您数据已成功保存。

## 注意事项
Excel 文件位置：ROM数据模板.xlsx 文件必须与 app.py 放在同一个文件夹下，否则程序将无法找到数据文件。

请勿修改列名：程序通过 Excel 文件中的列名（表头）来识别和读写数据。请不要手动修改 ROM数据模板.xlsx 文件中的第二行（即列标题行），以免程序出错。

备份数据：建议定期手动备份 ROM数据模板.xlsx 文件，以防意外数据丢失。

停止服务：如需停止应用，直接在运行 python app.py 的终端窗口中按下 Ctrl + C 即可。

祝您使用愉快！

